var SWFUpload;if(SWFUpload==undefined)SWFUpload=function(a){this.initSWFUpload(a)};SWFUpload.prototype.initSWFUpload=function(c){var a=this;try{a.customSettings={};a.settings=c;a.eventQueue=[];a.movieName="SWFUpload_"+SWFUpload.movieCount++;a.movieElement=null;SWFUpload.instances[a.movieName]=a;a.initSettings();a.loadFlash();a.displayDebugInfo()}catch(b){delete SWFUpload.instances[a.movieName];throw b;}};SWFUpload.instances={};SWFUpload.movieCount=0;SWFUpload.version="2.2.0 2009-03-25";SWFUpload.QUEUE_ERROR={QUEUE_LIMIT_EXCEEDED:-100,FILE_EXCEEDS_SIZE_LIMIT:-110,ZERO_BYTE_FILE:-120,INVALID_FILETYPE:-130};SWFUpload.UPLOAD_ERROR={HTTP_ERROR:-200,MISSING_UPLOAD_URL:-210,IO_ERROR:-220,SECURITY_ERROR:-230,UPLOAD_LIMIT_EXCEEDED:-240,UPLOAD_FAILED:-250,SPECIFIED_FILE_ID_NOT_FOUND:-260,FILE_VALIDATION_FAILED:-270,FILE_CANCELLED:-280,UPLOAD_STOPPED:-290};SWFUpload.FILE_STATUS={QUEUED:-1,IN_PROGRESS:-2,ERROR:-3,COMPLETE:-4,CANCELLED:-5};SWFUpload.BUTTON_ACTION={SELECT_FILE:-100,SELECT_FILES:-110,START_UPLOAD:-120};SWFUpload.CURSOR={ARROW:-1,HAND:-2};SWFUpload.WINDOW_MODE={WINDOW:"window",TRANSPARENT:"transparent",OPAQUE:"opaque"};SWFUpload.completeURL=function(a){if(typeof a!=="string"||a.match(/^https?:\/\//i)||a.match(/^\//))return a;var c=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""),b=window.location.pathname.lastIndexOf("/");if(b<=0)path="/";else path=window.location.pathname.substr(0,b)+"/";return path+a};SWFUpload.prototype.initSettings=function(){var b=null,c=false,a=this;a.ensureDefault=function(a,b){this.settings[a]=this.settings[a]==undefined?b:this.settings[a]};a.ensureDefault("upload_url","");a.ensureDefault("preserve_relative_urls",c);a.ensureDefault("file_post_name","Filedata");a.ensureDefault("post_params",{});a.ensureDefault("use_query_string",c);a.ensureDefault("requeue_on_error",c);a.ensureDefault("http_success",[]);a.ensureDefault("assume_success_timeout",0);a.ensureDefault("file_types","*.*");a.ensureDefault("file_types_description","All Files");a.ensureDefault("file_size_limit",0);a.ensureDefault("file_upload_limit",0);a.ensureDefault("file_queue_limit",0);a.ensureDefault("flash_url","swfupload.swf");a.ensureDefault("prevent_swf_caching",true);a.ensureDefault("button_image_url","");a.ensureDefault("button_width",1);a.ensureDefault("button_height",1);a.ensureDefault("button_text","");a.ensureDefault("button_text_style","color: #000000; font-size: 16pt;");a.ensureDefault("button_text_top_padding",0);a.ensureDefault("button_text_left_padding",0);a.ensureDefault("button_action",SWFUpload.BUTTON_ACTION.SELECT_FILES);a.ensureDefault("button_disabled",c);a.ensureDefault("button_placeholder_id","");a.ensureDefault("button_placeholder",b);a.ensureDefault("button_cursor",SWFUpload.CURSOR.ARROW);a.ensureDefault("button_window_mode",SWFUpload.WINDOW_MODE.WINDOW);a.ensureDefault("debug",c);a.settings.debug_enabled=a.settings.debug;a.settings.return_upload_start_handler=a.returnUploadStart;a.ensureDefault("swfupload_loaded_handler",b);a.ensureDefault("file_dialog_start_handler",b);a.ensureDefault("file_queued_handler",b);a.ensureDefault("file_queue_error_handler",b);a.ensureDefault("file_dialog_complete_handler",b);a.ensureDefault("upload_start_handler",b);a.ensureDefault("upload_progress_handler",b);a.ensureDefault("upload_error_handler",b);a.ensureDefault("upload_success_handler",b);a.ensureDefault("upload_complete_handler",b);a.ensureDefault("debug_handler",a.debugMessage);a.ensureDefault("custom_settings",{});a.customSettings=a.settings.custom_settings;if(!!a.settings.prevent_swf_caching)a.settings.flash_url=a.settings.flash_url+(a.settings.flash_url.indexOf("?")<0?"?":"&")+"preventswfcaching="+(new Date).getTime();if(!a.settings.preserve_relative_urls){a.settings.upload_url=SWFUpload.completeURL(a.settings.upload_url);a.settings.button_image_url=SWFUpload.completeURL(a.settings.button_image_url)}delete a.ensureDefault};SWFUpload.prototype.loadFlash=function(){var a=this,b,c;if(document.getElementById(a.movieName)!==null)throw"ID "+a.movieName+" is already in use. The Flash Object could not be added";b=document.getElementById(a.settings.button_placeholder_id)||a.settings.button_placeholder;if(b==undefined)throw"Could not find the placeholder element: "+a.settings.button_placeholder_id;c=document.createElement("div");c.innerHTML=a.getFlashHTML();b.parentNode.replaceChild(c.firstChild,b);if(window[a.movieName]==undefined)window[a.movieName]=a.getMovieElement()};SWFUpload.prototype.getFlashHTML=function(){var b='" />',a=this;return ['<object id="',a.movieName,'" type="application/x-shockwave-flash" data="',a.settings.flash_url,'" width="',a.settings.button_width,'" height="',a.settings.button_height,'" class="swfupload">','<param name="wmode" value="',a.settings.button_window_mode,b,'<param name="movie" value="',a.settings.flash_url,b,'<param name="quality" value="high" />','<param name="menu" value="false" />','<param name="allowScriptAccess" value="always" />','<param name="flashvars" value="'+a.getFlashVars()+b,"</object>"].join("")};SWFUpload.prototype.getFlashVars=function(){var a=this,c=a.buildParamString(),b=a.settings.http_success.join(",");return ["movieName=",encodeURIComponent(a.movieName),"&amp;uploadURL=",encodeURIComponent(a.settings.upload_url),"&amp;useQueryString=",encodeURIComponent(a.settings.use_query_string),"&amp;requeueOnError=",encodeURIComponent(a.settings.requeue_on_error),"&amp;httpSuccess=",encodeURIComponent(b),"&amp;assumeSuccessTimeout=",encodeURIComponent(a.settings.assume_success_timeout),"&amp;params=",encodeURIComponent(c),"&amp;filePostName=",encodeURIComponent(a.settings.file_post_name),"&amp;fileTypes=",encodeURIComponent(a.settings.file_types),"&amp;fileTypesDescription=",encodeURIComponent(a.settings.file_types_description),"&amp;fileSizeLimit=",encodeURIComponent(a.settings.file_size_limit),"&amp;fileUploadLimit=",encodeURIComponent(a.settings.file_upload_limit),"&amp;fileQueueLimit=",encodeURIComponent(a.settings.file_queue_limit),"&amp;debugEnabled=",encodeURIComponent(a.settings.debug_enabled),"&amp;buttonImageURL=",encodeURIComponent(a.settings.button_image_url),"&amp;buttonWidth=",encodeURIComponent(a.settings.button_width),"&amp;buttonHeight=",encodeURIComponent(a.settings.button_height),"&amp;buttonText=",encodeURIComponent(a.settings.button_text),"&amp;buttonTextTopPadding=",encodeURIComponent(a.settings.button_text_top_padding),"&amp;buttonTextLeftPadding=",encodeURIComponent(a.settings.button_text_left_padding),"&amp;buttonTextStyle=",encodeURIComponent(a.settings.button_text_style),"&amp;buttonAction=",encodeURIComponent(a.settings.button_action),"&amp;buttonDisabled=",encodeURIComponent(a.settings.button_disabled),"&amp;buttonCursor=",encodeURIComponent(a.settings.button_cursor)].join("")};SWFUpload.prototype.getMovieElement=function(){var a=this;if(a.movieElement==undefined)a.movieElement=document.getElementById(a.movieName);if(a.movieElement===null)throw"Could not find Flash element";return a.movieElement};SWFUpload.prototype.buildParamString=function(){var a=this.settings.post_params,c=[];if(typeof a==="object")for(var b in a)a.hasOwnProperty(b)&&c.push(encodeURIComponent(b.toString())+"="+encodeURIComponent(a[b].toString()));return c.join("&amp;")};SWFUpload.prototype.destroy=function(){var a=null,b=this;try{b.cancelUpload(a,false);var c=a;c=b.getMovieElement();if(c&&typeof c.CallFunction==="unknown"){for(var d in c)try{if(typeof c[d]==="function")c[d]=a}catch(e){}try{c.parentNode.removeChild(c)}catch(g){}}window[b.movieName]=a;SWFUpload.instances[b.movieName]=a;delete SWFUpload.instances[b.movieName];b.movieElement=a;b.settings=a;b.customSettings=a;b.eventQueue=a;b.movieName=a;return true}catch(f){return false}};SWFUpload.prototype.displayDebugInfo=function(){var d="function",c="\t",a="\n",b=this;b.debug(["---SWFUpload Instance Info---\n","Version: ",SWFUpload.version,a,"Movie Name: ",b.movieName,a,"Settings:\n",c,"upload_url:               ",b.settings.upload_url,a,c,"flash_url:                ",b.settings.flash_url,a,c,"use_query_string:         ",b.settings.use_query_string.toString(),a,c,"requeue_on_error:         ",b.settings.requeue_on_error.toString(),a,c,"http_success:             ",b.settings.http_success.join(", "),a,c,"assume_success_timeout:   ",b.settings.assume_success_timeout,a,c,"file_post_name:           ",b.settings.file_post_name,a,c,"post_params:              ",b.settings.post_params.toString(),a,c,"file_types:               ",b.settings.file_types,a,c,"file_types_description:   ",b.settings.file_types_description,a,c,"file_size_limit:          ",b.settings.file_size_limit,a,c,"file_upload_limit:        ",b.settings.file_upload_limit,a,c,"file_queue_limit:         ",b.settings.file_queue_limit,a,c,"debug:                    ",b.settings.debug.toString(),a,c,"prevent_swf_caching:      ",b.settings.prevent_swf_caching.toString(),a,c,"button_placeholder_id:    ",b.settings.button_placeholder_id.toString(),a,c,"button_placeholder:       ",b.settings.button_placeholder?"Set":"Not Set",a,c,"button_image_url:         ",b.settings.button_image_url.toString(),a,c,"button_width:             ",b.settings.button_width.toString(),a,c,"button_height:            ",b.settings.button_height.toString(),a,c,"button_text:              ",b.settings.button_text.toString(),a,c,"button_text_style:        ",b.settings.button_text_style.toString(),a,c,"button_text_top_padding:  ",b.settings.button_text_top_padding.toString(),a,c,"button_text_left_padding: ",b.settings.button_text_left_padding.toString(),a,c,"button_action:            ",b.settings.button_action.toString(),a,c,"button_disabled:          ",b.settings.button_disabled.toString(),a,c,"custom_settings:          ",b.settings.custom_settings.toString(),a,"Event Handlers:\n",c,"swfupload_loaded_handler assigned:  ",(typeof b.settings.swfupload_loaded_handler===d).toString(),a,c,"file_dialog_start_handler assigned: ",(typeof b.settings.file_dialog_start_handler===d).toString(),a,c,"file_queued_handler assigned:       ",(typeof b.settings.file_queued_handler===d).toString(),a,c,"file_queue_error_handler assigned:  ",(typeof b.settings.file_queue_error_handler===d).toString(),a,c,"upload_start_handler assigned:      ",(typeof b.settings.upload_start_handler===d).toString(),a,c,"upload_progress_handler assigned:   ",(typeof b.settings.upload_progress_handler===d).toString(),a,c,"upload_error_handler assigned:      ",(typeof b.settings.upload_error_handler===d).toString(),a,c,"upload_success_handler assigned:    ",(typeof b.settings.upload_success_handler===d).toString(),a,c,"upload_complete_handler assigned:   ",(typeof b.settings.upload_complete_handler===d).toString(),a,c,"debug_handler assigned:             ",(typeof b.settings.debug_handler===d).toString(),a].join(""))};SWFUpload.prototype.addSetting=function(b,a,c){if(a==undefined)return this.settings[b]=c;else return this.settings[b]=a};SWFUpload.prototype.getSetting=function(a){if(this.settings[a]!=undefined)return this.settings[a];return ""};SWFUpload.prototype.callFlash=function(functionName,argumentArray){argumentArray=argumentArray||[];var movieElement=this.getMovieElement(),returnValue,returnString;try{returnString=movieElement.CallFunction('<invoke name="'+functionName+'" returntype="javascript">'+__flash__argumentsToXML(argumentArray,0)+"</invoke>");returnValue=eval(returnString)}catch(ex){throw"Call to "+functionName+" failed";}if(returnValue!=undefined&&typeof returnValue.post==="object")returnValue=this.unescapeFilePostParams(returnValue);return returnValue};SWFUpload.prototype.selectFile=function(){this.callFlash("SelectFile")};SWFUpload.prototype.selectFiles=function(){this.callFlash("SelectFiles")};SWFUpload.prototype.startUpload=function(a){this.callFlash("StartUpload",[a])};SWFUpload.prototype.cancelUpload=function(b,a){if(a!==false)a=true;this.callFlash("CancelUpload",[b,a])};SWFUpload.prototype.stopUpload=function(){this.callFlash("StopUpload")};SWFUpload.prototype.getStats=function(){return this.callFlash("GetStats")};SWFUpload.prototype.setStats=function(a){this.callFlash("SetStats",[a])};SWFUpload.prototype.getFile=function(a){if(typeof a==="number")return this.callFlash("GetFileByIndex",[a]);else return this.callFlash("GetFile",[a])};SWFUpload.prototype.addFileParam=function(a,c,b){return this.callFlash("AddFileParam",[a,c,b])};SWFUpload.prototype.removeFileParam=function(a,b){this.callFlash("RemoveFileParam",[a,b])};SWFUpload.prototype.setUploadURL=function(a){this.settings.upload_url=a.toString();this.callFlash("SetUploadURL",[a])};SWFUpload.prototype.setPostParams=function(a){this.settings.post_params=a;this.callFlash("SetPostParams",[a])};SWFUpload.prototype.addPostParam=function(b,a){this.settings.post_params[b]=a;this.callFlash("SetPostParams",[this.settings.post_params])};SWFUpload.prototype.removePostParam=function(a){delete this.settings.post_params[a];this.callFlash("SetPostParams",[this.settings.post_params])};SWFUpload.prototype.setFileTypes=function(b,a){this.settings.file_types=b;this.settings.file_types_description=a;this.callFlash("SetFileTypes",[b,a])};SWFUpload.prototype.setFileSizeLimit=function(a){this.settings.file_size_limit=a;this.callFlash("SetFileSizeLimit",[a])};SWFUpload.prototype.setFileUploadLimit=function(a){this.settings.file_upload_limit=a;this.callFlash("SetFileUploadLimit",[a])};SWFUpload.prototype.setFileQueueLimit=function(a){this.settings.file_queue_limit=a;this.callFlash("SetFileQueueLimit",[a])};SWFUpload.prototype.setFilePostName=function(a){this.settings.file_post_name=a;this.callFlash("SetFilePostName",[a])};SWFUpload.prototype.setUseQueryString=function(a){this.settings.use_query_string=a;this.callFlash("SetUseQueryString",[a])};SWFUpload.prototype.setRequeueOnError=function(a){this.settings.requeue_on_error=a;this.callFlash("SetRequeueOnError",[a])};SWFUpload.prototype.setHTTPSuccess=function(a){if(typeof a==="string")a=a.replace(" ","").split(",");this.settings.http_success=a;this.callFlash("SetHTTPSuccess",[a])};SWFUpload.prototype.setAssumeSuccessTimeout=function(a){this.settings.assume_success_timeout=a;this.callFlash("SetAssumeSuccessTimeout",[a])};SWFUpload.prototype.setDebugEnabled=function(a){this.settings.debug_enabled=a;this.callFlash("SetDebugEnabled",[a])};SWFUpload.prototype.setButtonImageURL=function(a){if(a==undefined)a="";this.settings.button_image_url=a;this.callFlash("SetButtonImageURL",[a])};SWFUpload.prototype.setButtonDimensions=function(d,b){var a=this;a.settings.button_width=d;a.settings.button_height=b;var c=a.getMovieElement();if(c!=undefined){c.style.width=d+"px";c.style.height=b+"px"}a.callFlash("SetButtonDimensions",[d,b])};SWFUpload.prototype.setButtonText=function(a){this.settings.button_text=a;this.callFlash("SetButtonText",[a])};SWFUpload.prototype.setButtonTextPadding=function(a,b){this.settings.button_text_top_padding=b;this.settings.button_text_left_padding=a;this.callFlash("SetButtonTextPadding",[a,b])};SWFUpload.prototype.setButtonTextStyle=function(a){this.settings.button_text_style=a;this.callFlash("SetButtonTextStyle",[a])};SWFUpload.prototype.setButtonDisabled=function(a){this.settings.button_disabled=a;this.callFlash("SetButtonDisabled",[a])};SWFUpload.prototype.setButtonAction=function(a){this.settings.button_action=a;this.callFlash("SetButtonAction",[a])};SWFUpload.prototype.setButtonCursor=function(a){this.settings.button_cursor=a;this.callFlash("SetButtonCursor",[a])};SWFUpload.prototype.queueEvent=function(b,a){var c=this;if(a==undefined)a=[];else if(!(a instanceof Array))a=[a];var d=c;if(typeof c.settings[b]==="function"){c.eventQueue.push(function(){this.settings[b].apply(this,a)});setTimeout(function(){d.executeNextEvent()},0)}else if(c.settings[b]!==null)throw"Event handler "+b+" is unknown or is not a function";};SWFUpload.prototype.executeNextEvent=function(){var a=this.eventQueue?this.eventQueue.shift():null;typeof a==="function"&&a.apply(this)};SWFUpload.prototype.unescapeFilePostParams=function(a){var f=/[$]([0-9a-f]{4})/i,e={},b;if(a!=undefined){for(var d in a.post)if(a.post.hasOwnProperty(d)){b=d;var c;while((c=f.exec(b))!==null)b=b.replace(c[0],String.fromCharCode(parseInt("0x"+c[1],16)));e[b]=a.post[d]}a.post=e}return a};SWFUpload.prototype.testExternalInterface=function(){try{return this.callFlash("TestExternalInterface")}catch(a){return false}};SWFUpload.prototype.flashReady=function(){var a=this,b=a.getMovieElement();if(!b){a.debug("Flash called back ready but the flash movie can't be found.");return}a.cleanUp(b);a.queueEvent("swfupload_loaded_handler")};SWFUpload.prototype.cleanUp=function(a){try{if(this.movieElement&&typeof a.CallFunction==="unknown"){this.debug("Removing Flash functions hooks (this should only run in IE and should prevent memory leaks)");for(var b in a)try{if(typeof a[b]==="function")a[b]=null}catch(d){}}}catch(c){}window["__flash__removeCallback"]=function(a,c){try{if(a)a[c]=null}catch(b){}}};SWFUpload.prototype.fileDialogStart=function(){this.queueEvent("file_dialog_start_handler")};SWFUpload.prototype.fileQueued=function(a){a=this.unescapeFilePostParams(a);this.queueEvent("file_queued_handler",a)};SWFUpload.prototype.fileQueueError=function(a,b,c){a=this.unescapeFilePostParams(a);this.queueEvent("file_queue_error_handler",[a,b,c])};SWFUpload.prototype.fileDialogComplete=function(a,c,b){this.queueEvent("file_dialog_complete_handler",[a,c,b])};SWFUpload.prototype.uploadStart=function(a){a=this.unescapeFilePostParams(a);this.queueEvent("return_upload_start_handler",a)};SWFUpload.prototype.returnUploadStart=function(c){var b=this,a;if(typeof b.settings.upload_start_handler==="function"){c=b.unescapeFilePostParams(c);a=b.settings.upload_start_handler.call(b,c)}else if(b.settings.upload_start_handler!=undefined)throw"upload_start_handler must be a function";if(a===undefined)a=true;a=!!a;b.callFlash("ReturnUploadStart",[a])};SWFUpload.prototype.uploadProgress=function(a,b,c){a=this.unescapeFilePostParams(a);this.queueEvent("upload_progress_handler",[a,b,c])};SWFUpload.prototype.uploadError=function(a,b,c){a=this.unescapeFilePostParams(a);this.queueEvent("upload_error_handler",[a,b,c])};SWFUpload.prototype.uploadSuccess=function(a,c,b){a=this.unescapeFilePostParams(a);this.queueEvent("upload_success_handler",[a,c,b])};SWFUpload.prototype.uploadComplete=function(a){a=this.unescapeFilePostParams(a);this.queueEvent("upload_complete_handler",a)};SWFUpload.prototype.debug=function(a){this.queueEvent("debug_handler",a)};SWFUpload.prototype.debugMessage=function(a){if(this.settings.debug){var b,c=[];if(typeof a==="object"&&typeof a.name==="string"&&typeof a.message==="string"){for(var d in a)a.hasOwnProperty(d)&&c.push(d+": "+a[d]);b=c.join("\n")||"";c=b.split("\n");b="EXCEPTION: "+c.join("\nEXCEPTION: ");SWFUpload.Console.writeLine(b)}else SWFUpload.Console.writeLine(a)}};SWFUpload.Console={};SWFUpload.Console.writeLine=function(e){var d="SWFUpload_Console",a,b;try{a=document.getElementById(d);if(!a){b=document.createElement("form");document.getElementsByTagName("body")[0].appendChild(b);a=document.createElement("textarea");a.id=d;a.style.fontFamily="monospace";a.setAttribute("wrap","off");a.wrap="off";a.style.overflow="auto";a.style.width="700px";a.style.height="350px";a.style.margin="5px";b.appendChild(a)}a.value+=e+"\n";a.scrollTop=a.scrollHeight-a.clientHeight}catch(c){alert("Exception: "+c.name+" Message: "+c.message)}}