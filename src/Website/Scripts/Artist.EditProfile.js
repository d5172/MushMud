if(!window.Shared)window.Shared={};Shared.Common=new function(){var e="ui-state-highlight",d="#userMessage",_my=this;_my.ProgressImageUrl="/content/progress.gif";_my.ProgressImage='<img src="'+_my.ProgressImageUrl+'" />';_my.SuggestTagsUrl="/Works/SuggestTags";_my.InitialUserMessage=null;_my.Ready=function(){var a="#txtSearch";$(a).autocomplete("/Music/AutoCompleteSearchTerm/",{delay:40,selectFirst:true,multiple:true,highlight:false});$("#lnkSearch").click(function(e){e.preventDefault();var b=$(a),d=b.val();if(d!=""){var c=$(this).parents("form");c.submit()}});$(".navTab").each(function(){var a=$(this),c=a.find("a"),b=c.attr("href");if(document.location.href.indexOf(b)!=-1){a.addClass("ui-state-active");return false}});$(d).click(function(){$(d).fadeOut(100)});_my.InitialUserMessage!=null&&_my.ShowUserMessage(_my.InitialUserMessage)};_my.HijaxButtonHoverStates=function(){var a="ui-state-hover";$(".fg-button:not(.ui-state-disabled)").hover(function(){$(this).addClass(a)},function(){$(this).removeClass(a)})};_my.ShowUserMessage=function(a){var b=$(d);b.toggleClass("ui-state-error",a.Type==0).toggleClass(e,a.Type==1).toggleClass("Warning",a.Type==2).html(a.Message).show();a.Type!=0&&b.delay(2500).fadeOut(100)};_my.ShowUserMessages=function(c){var a=$(d);a.toggleClass(e);a.empty();var b=true;$.each(c,function(e,c){a.append($("<div></div>"));var d=a.find("div:last");d.toggleClass("Error",c.Type==0);d.toggleClass("Info",c.Type==1);d.toggleClass("Warning",c.Type==2);d.html(c.Message);if(c.Type==0)b=false});a.show();b&&a.delay(2500).fadeOut(100)};_my.IsEmpty=function(a){return a.replace(/\s/g,"")==""};_my.FileSize=function(a){var c=["bytes","kb","MB","GB","TB","PB"],b=Math.floor(Math.log(a)/Math.log(1024));return (a/Math.pow(1024,Math.floor(b))).toFixed(2)+" "+c[b]};_my.ParseJson=function(jsonString){return eval("("+jsonString+")")}};$(function(){Shared.Common.Ready();Shared.Common.HijaxButtonHoverStates()});if(!window.Shared)window.Shared={};Shared.OptionsLink=new function(){var h=".optionsListBox",g="ui-icon-triangle-1-s",f="ui-corner-top",e="ui-corner-all",c="ui-icon-triangle-1-n",d="span.ui-icon",b=".optionsLink",a=".optionsBox",l=this;l.HijaxOptionsLinks=function(){$(document).unbind("click");$(document).bind("click",function(d){var c=$(d.target);if(c.parents(a).length>0){d.preventDefault();j(c.parents(b))}else i(null)})};function i(c){var a;if(c)a=$(b).not(c);else a=$(b);a.each(function(){k($(this))})}function k(b){var i=b.find(d);if(i.hasClass(c)){b.addClass(e).removeClass(f);i.removeClass(c).addClass(g);var j=b.parents(a).find(h);j.hide()}}function j(b){b.toggleClass(e).toggleClass(f);var k=b.find(d);k.toggleClass(g).toggleClass(c);var j=b.parents(a).find(h);j.toggle("blind",null,50);i(b)}};if(!window.Shared)window.Shared={};Shared.UploadManager=new function(){var f="#status_",o="ui-state-active",n="font-weight",m="ui-state-disabled",l="#fileQueueLabel",j="value",i="option",e="#uploadProgress",g="#row_",h=".lnkRemoveQueuedFile",d="#fileQueueList",c=true,k="#btnUpload",b=false,a=this;a.Uploading=b;a.CurrentSWF=null;a.UserMessages=[];a.CancelAllUploads=function(){if(a.Uploading){a.Uploading=b;a.CurrentSWF&&a.CurrentSWF.cancelUpload()}if(a.CurrentSWF){a.CurrentSWF.destroy();a.CurrentSWF=null}a.UserMessages=[]};a.FileDialogComplete=function(){var a="#fileQueue",m=$("#"+this.button_placeholder_id),f=Shared.UploadManager.CurrentSWF.getStats().files_queued;if(f>0){$(a).show();$(k).click(function(a){a.preventDefault();m.show();Shared.UploadManager.Uploading=c;Shared.UploadManager.CurrentSWF.startUpload()});$(d).find(h).click(function(i){i.preventDefault();var e=$(this).attr("id");Shared.UploadManager.CurrentSWF.cancelUpload(e);var f=$(this).parents(d),h=f.find(g+e);h.empty();Shared.UploadManager.CurrentSWF.setButtonDisabled(b);var c=Shared.UploadManager.CurrentSWF.getStats().files_queued;p(c);c==0&&$(a).hide()});$(e).progressbar();$(e).progressbar(i,j,0);f==Shared.UploadManager.CurrentSWF.settings.file_queue_limit&&Shared.UploadManager.CurrentSWF.setButtonDisabled(c);p(f)}else{$(a).hide();$(l).empty()}};function p(a){$(l).html(a+" file"+(a==1?"":"s")+" selected.")}a.FileQueued=function(a){var b="<tr id='row_"+a.id+"'><td width='100%'>";b+=a.name;b+="</td><td class='nowrap'>";b+=Shared.Common.FileSize(a.size);b+="</td><td>";if(!Shared.Common.IsEmpty(a.type))b+=a.type.substring(0,1)=="."?a.type.substring(1):a.type;b+="</td><td id='status_"+a.id+"'>Ready</td>";b+="<td><a href='#' id='"+a.id+"' class='lnkRemoveQueuedFile'>Remove</a></td></tr>";$(d).append(b)};a.UploadStart=function(a){$(h).hide();$("#uploadThrobber").show().html(Shared.Common.ProgressImage);$(k).addClass(m);this.setButtonDisabled(c);$(g+a.id).css(n,"bold").addClass(o);$(f+a.id).html("Uploading...");$(e).progressbar(i,j,0)};a.UploadProgress=function(b,c){var a=Math.ceil(c/b.size*100);$(e).progressbar(i,j,a);if(a===100)$(f+b.id).html("Processing...");else $(f+b.id).html(a+"%")};a.UploadSuccess=function(d,c){var b=Shared.Common.ParseJson(c);a.UserMessages.push(b)};a.UploadComplete=function(b){var c=$(d),a=c.find(g+b.id);a.css(n,"normal").removeClass(o).addClass(m);a.find(f+b.id).html("Done.");var e=a.find(h);e.hide()};a.FileQueueError=function(b,c,d){var a=this;try{switch(c){case SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED:try{popupError("Sorry, you can only queue "+a.settings.file_queue_limit+" files at a time.")}catch(e){a.debug(e)}break;case SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:try{popupError("Sorry, but"+b.name+" is too large.  The max size is "+a.settings.file_size_limit)}catch(e){a.debug(e)}break;case SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE:try{popupError("The file you selected ("+b.name+") is not a valid file.")}catch(e){a.debug(e)}case SWFUpload.QUEUE_ERROR.INVALID_FILETYPE:try{popupError("Sorry, but only "+a.settings.file_types_description+" allowed.")}catch(e){a.debug(e)}default:popupError(d)}}catch(e){a.debug(e)}};a.UploadError=function(e,f,g){var d=this;global_uploadingImage=b;var a;try{switch(f){case SWFUpload.UPLOAD_ERROR.FILE_CANCELLED:try{a=new FileProgress(e,d.customSettings.upload_target);a.setCancelled();a.setStatus("Cancelled");a.toggleCancel(b)}catch(h){d.debug(h)}break;case SWFUpload.UPLOAD_ERROR.UPLOAD_STOPPED:try{a=new FileProgress(e,d.customSettings.upload_target);a.setCancelled();a.setStatus("Stopped");a.toggleCancel(c)}catch(h){d.debug(h)}default:popupError(g)}}catch(h){d.debug(h)}}};if(!window.Artist)window.Artist={};Artist.BioForm=new function(){var a=this;a.HijaxForm=function(a){a.find("textarea:first").focus()}};if(!window.Artist)window.Artist={};Artist.EditProfile=new function(){var b="destroy",a="#uploadThrobber",e="#uploadWindow",d="#editBox",c="#viewBox",l=this;l.HijaxAll=function(){var a=".editProfile";Shared.OptionsLink.HijaxOptionsLinks();$(".optionsListBox").click(function(d){var c=".editImage";d.preventDefault();var b=$(d.target);if(b.is(a))f(b);else if(b.parent().is(a))f(b.parent());else if(b.is(c))g(b);else b.parent().is(c)&&g(b.parent())});$("#emptyBio").click(function(){$(a).click()})};function f(e){var b=$(c),a=$(d);b.hide();a.show();a.html(Shared.Common.ProgressImage);var f=e.attr("href");$.ajax({type:"GET",url:f,dataType:"html",cache:false,success:function(d){a.hide();a.html(d);a.fadeIn("fast");var b=a.find("form");Artist.BioForm.HijaxForm(b);var c=b.find("a.cancel");c.click(function(a){a.preventDefault();h()});b.submit(function(){k(b);return false});Shared.Common.HijaxButtonHoverStates()},error:function(b){a.html(b.responseText)}})}function h(){$(d).empty().hide();$(c).show()}function k(b){if(b.valid()){var e=$(c),a=$(d);a.html(Shared.Common.ProgressImage);var f=b.attr("action");b.valid()&&$.ajax({type:"POST",url:f,data:b.serialize(),dataType:"json",success:function(b){$.ajax({type:"GET",dataType:"html",cache:false,url:global_ArtistBioUrl,success:function(b){a.hide();e.show();e.html(b)},error:function(b){a.html(b.responseText)}});Shared.Common.ShowUserMessage(b)},error:function(b){a.html(b.responseText)}})}}function g(h){Shared.UploadManager.CancelAllUploads();var g=$("#imgBox"),l=g.find("img").attr("id"),c=$(e);c.attr("title","Change the picture");c.find("p").html("Select a JPEG image to upload.  This will be your profile picture.  Maximum file size allowed is 3MB.");var f=c.find(".flashBox");f.empty();var d="up"+(new Date).getTime();f.append('<div class="uploadButton" id="'+d+'"></div>');var k=$(h).attr("href");Shared.UploadManager.CurrentSWF=new SWFUpload({post_params:{AUTHID:global_SWFParam,ajax:true},upload_url:k,file_size_limit:"3 MB",file_types:"*.jpg",file_types_description:"JPG Images",file_upload_limit:"0",file_queue_limit:"1",button_placeholder_id:d,button_image_url:"/content/browse_file_hs.png",button_width:151,button_height:27,button_cursor:SWFUpload.CURSOR.HAND,flash_url:global_SWFUrl,custom_settings:{target_div:"uploadWindow"},file_dialog_complete_handler:Shared.UploadManager.FileDialogComplete,file_queued_handler:Shared.UploadManager.FileQueued,file_queue_error_handler:Shared.UploadManager.FileQueueError,upload_start_handler:Shared.UploadManager.UploadStart,upload_progress_handler:Shared.UploadManager.UploadProgress,upload_error_handler:Shared.UploadManager.UploadError,upload_complete_handler:Shared.UploadManager.UploadComplete,queue_complete_handler:i,upload_success_handler:j});$("#fileQueue").hide();$("#fileQueueList").empty();$("#btnUpload").removeClass("ui-state-disabled");c.dialog({resizable:true,height:375,width:550,modal:true,overlay:{backgroundColor:"#000",opacity:.5},buttons:{Cancel:function(){Shared.UploadManager.CancelAllUploads();$(a).hide();$(this).dialog("close").dialog(b)}},close:function(){Shared.UploadManager.CancelAllUploads();$(a).hide();$(this).dialog(b)}})}function i(){$(a).hide();$(e).dialog("close").dialog(b);Shared.UploadManager.CancelAllUploads()}function j(e,b){var d=$("#imgBox"),a=d.find("img");a.attr("src",Shared.Common.ProgressImageUrl);var c=Shared.Common.ParseJson(b);a.attr("src",c.ImageUrl);Shared.Common.ShowUserMessage({Type:1,Message:"Picture was changed."})}};$(function(){Artist.EditProfile.HijaxAll()})