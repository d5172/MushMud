if(!window.Shared)window.Shared={};Shared.Common=new function(){var e="ui-state-highlight",d="#userMessage",_my=this;_my.ProgressImageUrl="/content/progress.gif";_my.ProgressImage='<img src="'+_my.ProgressImageUrl+'" />';_my.SuggestTagsUrl="/Works/SuggestTags";_my.InitialUserMessage=null;_my.Ready=function(){var a="#txtSearch";$(a).autocomplete("/Music/AutoCompleteSearchTerm/",{delay:40,selectFirst:true,multiple:true,highlight:false});$("#lnkSearch").click(function(e){e.preventDefault();var b=$(a),d=b.val();if(d!=""){var c=$(this).parents("form");c.submit()}});$(".navTab").each(function(){var a=$(this),c=a.find("a"),b=c.attr("href");if(document.location.href.indexOf(b)!=-1){a.addClass("ui-state-active");return false}});$(d).click(function(){$(d).fadeOut(100)});_my.InitialUserMessage!=null&&_my.ShowUserMessage(_my.InitialUserMessage)};_my.HijaxButtonHoverStates=function(){var a="ui-state-hover";$(".fg-button:not(.ui-state-disabled)").hover(function(){$(this).addClass(a)},function(){$(this).removeClass(a)})};_my.ShowUserMessage=function(a){var b=$(d);b.toggleClass("ui-state-error",a.Type==0).toggleClass(e,a.Type==1).toggleClass("Warning",a.Type==2).html(a.Message).show();a.Type!=0&&b.delay(2500).fadeOut(100)};_my.ShowUserMessages=function(c){var a=$(d);a.toggleClass(e);a.empty();var b=true;$.each(c,function(e,c){a.append($("<div></div>"));var d=a.find("div:last");d.toggleClass("Error",c.Type==0);d.toggleClass("Info",c.Type==1);d.toggleClass("Warning",c.Type==2);d.html(c.Message);if(c.Type==0)b=false});a.show();b&&a.delay(2500).fadeOut(100)};_my.IsEmpty=function(a){return a.replace(/\s/g,"")==""};_my.FileSize=function(a){var c=["bytes","kb","MB","GB","TB","PB"],b=Math.floor(Math.log(a)/Math.log(1024));return (a/Math.pow(1024,Math.floor(b))).toFixed(2)+" "+c[b]};_my.ParseJson=function(jsonString){return eval("("+jsonString+")")}};$(function(){Shared.Common.Ready();Shared.Common.HijaxButtonHoverStates()});if(!window.Shared)window.Shared={};Shared.OptionsLink=new function(){var h=".optionsListBox",g="ui-icon-triangle-1-s",f="ui-corner-top",e="ui-corner-all",c="ui-icon-triangle-1-n",d="span.ui-icon",b=".optionsLink",a=".optionsBox",l=this;l.HijaxOptionsLinks=function(){$(document).unbind("click");$(document).bind("click",function(d){var c=$(d.target);if(c.parents(a).length>0){d.preventDefault();j(c.parents(b))}else i(null)})};function i(c){var a;if(c)a=$(b).not(c);else a=$(b);a.each(function(){k($(this))})}function k(b){var i=b.find(d);if(i.hasClass(c)){b.addClass(e).removeClass(f);i.removeClass(c).addClass(g);var j=b.parents(a).find(h);j.hide()}}function j(b){b.toggleClass(e).toggleClass(f);var k=b.find(d);k.toggleClass(g).toggleClass(c);var j=b.parents(a).find(h);j.toggle("blind",null,50);i(b)}};if(!window.Shared)window.Shared={};Shared.UploadManager=new function(){var f="#status_",o="ui-state-active",n="font-weight",m="ui-state-disabled",l="#fileQueueLabel",j="value",i="option",e="#uploadProgress",g="#row_",h=".lnkRemoveQueuedFile",d="#fileQueueList",c=true,k="#btnUpload",b=false,a=this;a.Uploading=b;a.CurrentSWF=null;a.UserMessages=[];a.CancelAllUploads=function(){if(a.Uploading){a.Uploading=b;a.CurrentSWF&&a.CurrentSWF.cancelUpload()}if(a.CurrentSWF){a.CurrentSWF.destroy();a.CurrentSWF=null}a.UserMessages=[]};a.FileDialogComplete=function(){var a="#fileQueue",m=$("#"+this.button_placeholder_id),f=Shared.UploadManager.CurrentSWF.getStats().files_queued;if(f>0){$(a).show();$(k).click(function(a){a.preventDefault();m.show();Shared.UploadManager.Uploading=c;Shared.UploadManager.CurrentSWF.startUpload()});$(d).find(h).click(function(i){i.preventDefault();var e=$(this).attr("id");Shared.UploadManager.CurrentSWF.cancelUpload(e);var f=$(this).parents(d),h=f.find(g+e);h.empty();Shared.UploadManager.CurrentSWF.setButtonDisabled(b);var c=Shared.UploadManager.CurrentSWF.getStats().files_queued;p(c);c==0&&$(a).hide()});$(e).progressbar();$(e).progressbar(i,j,0);f==Shared.UploadManager.CurrentSWF.settings.file_queue_limit&&Shared.UploadManager.CurrentSWF.setButtonDisabled(c);p(f)}else{$(a).hide();$(l).empty()}};function p(a){$(l).html(a+" file"+(a==1?"":"s")+" selected.")}a.FileQueued=function(a){var b="<tr id='row_"+a.id+"'><td width='100%'>";b+=a.name;b+="</td><td class='nowrap'>";b+=Shared.Common.FileSize(a.size);b+="</td><td>";if(!Shared.Common.IsEmpty(a.type))b+=a.type.substring(0,1)=="."?a.type.substring(1):a.type;b+="</td><td id='status_"+a.id+"'>Ready</td>";b+="<td><a href='#' id='"+a.id+"' class='lnkRemoveQueuedFile'>Remove</a></td></tr>";$(d).append(b)};a.UploadStart=function(a){$(h).hide();$("#uploadThrobber").show().html(Shared.Common.ProgressImage);$(k).addClass(m);this.setButtonDisabled(c);$(g+a.id).css(n,"bold").addClass(o);$(f+a.id).html("Uploading...");$(e).progressbar(i,j,0)};a.UploadProgress=function(b,c){var a=Math.ceil(c/b.size*100);$(e).progressbar(i,j,a);if(a===100)$(f+b.id).html("Processing...");else $(f+b.id).html(a+"%")};a.UploadSuccess=function(d,c){var b=Shared.Common.ParseJson(c);a.UserMessages.push(b)};a.UploadComplete=function(b){var c=$(d),a=c.find(g+b.id);a.css(n,"normal").removeClass(o).addClass(m);a.find(f+b.id).html("Done.");var e=a.find(h);e.hide()};a.FileQueueError=function(b,c,d){var a=this;try{switch(c){case SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED:try{popupError("Sorry, you can only queue "+a.settings.file_queue_limit+" files at a time.")}catch(e){a.debug(e)}break;case SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:try{popupError("Sorry, but"+b.name+" is too large.  The max size is "+a.settings.file_size_limit)}catch(e){a.debug(e)}break;case SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE:try{popupError("The file you selected ("+b.name+") is not a valid file.")}catch(e){a.debug(e)}case SWFUpload.QUEUE_ERROR.INVALID_FILETYPE:try{popupError("Sorry, but only "+a.settings.file_types_description+" allowed.")}catch(e){a.debug(e)}default:popupError(d)}}catch(e){a.debug(e)}};a.UploadError=function(e,f,g){var d=this;global_uploadingImage=b;var a;try{switch(f){case SWFUpload.UPLOAD_ERROR.FILE_CANCELLED:try{a=new FileProgress(e,d.customSettings.upload_target);a.setCancelled();a.setStatus("Cancelled");a.toggleCancel(b)}catch(h){d.debug(h)}break;case SWFUpload.UPLOAD_ERROR.UPLOAD_STOPPED:try{a=new FileProgress(e,d.customSettings.upload_target);a.setCancelled();a.setStatus("Stopped");a.toggleCancel(c)}catch(h){d.debug(h)}default:popupError(g)}}catch(h){d.debug(h)}}};if(!window.CollectionWork)window.CollectionWork={};CollectionWork.CollectionWorkForm=new function(){var a=this;a.HijaxForm=function(b){var a=true;b.find("a.licenseHelp").click(function(d){d.preventDefault();var b=$("#modalWindow"),c=$(d.target).attr("href");if(!c)c=$(d.target).parent().attr("href");b.attr("title","Available Licenses");b.dialog({resizable:a,height:300,width:450,buttons:{Close:function(){b.dialog("destroy")}},open:function(){b.html(Shared.Common.ProgressImage);$.get(c,"",function(a){b.html(a)},"html")},close:function(){b.dialog("destroy")}})});b.find(".suggestTags").autocomplete(Shared.Common.SuggestTagsUrl,{delay:40,selectFirst:a,multiple:a,highlight:false});b.find(".dateInput").datepicker({changeYear:a,defaultDate:0});b.validate({errorClass:"ui-state-error",errorElement:"div",rules:{Title:{required:a,maxlength:100},ReleaseDate:{required:a,date:a}},messages:{Title:{maxlength:"The Title is too long (up to 100 characters allowed)"}}});b.find("input:first").focus()}};if(!window.Works)window.Works={};Works.CollectionWorkList=new function(){var e="src",k="#uploadThrobber",j="ui-state-disabled",r="#uploadWindow",q=".imgContainer",a="destroy",b="close",o="#000",d=true,n="title",p="#modalWindow",i="json",h="href",l="div.collectionEditContainer",s="div.collectionViewContainer",f=".collectionBox",m="a.cancel",c=false,g=".deleteImage",B=this;B.HijaxCollections=function(){$(".optionsListBox").click(function(f){var e=".addSongs",d=".editImage",c=".deleteCollection",b=".editCollection";f.preventDefault();var a=$(f.target);if(a.is(b))u(a);else if(a.parent().is(b))u(a.parent());else if(a.is(c))t(a);else if(a.parent().is(c))t(a.parent());else if(a.is(d))x(a);else if(a.parent().is(d))x(a.parent());else if(a.is(g))w(a);else if(a.parent().is(g))w(a.parent());else if(a.is(e))Shared.AudioWorkList.HandleAddSongsClick(a);else a.parent().is(e)&&Shared.AudioWorkList.HandleAddSongsClick(a.parent())});$(".addTracks").click(function(a){a.preventDefault();var b=$(a.target);Shared.AudioWorkList.HandleAddSongsClick(b)});$(".addCollection").click(function(b){b.preventDefault();var a=$(this).parent().parent().find("div.colFormContainer");a.html(Shared.Common.ProgressImage);$.ajax({type:"GET",url:this.href,dataType:"html",cache:c,success:function(e){a.html(e);var b=a.find("form");CollectionWork.CollectionWorkForm.HijaxForm(b);var d=b.find(m);d.click(function(b){b.preventDefault();a.html("")});b.submit(function(){v(b,a);return c});Shared.Common.HijaxButtonHoverStates()},error:function(b){a.html(b.responseText)}});return c})};function u(d){var b=d.parents(f),e=b.find(s);e.hide();var a=b.find(l);a.show();a.html(Shared.Common.ProgressImage);var g=d.attr(h);$.ajax({type:"GET",url:g,dataType:"html",cache:c,success:function(e){a.hide();a.html(e);a.fadeIn("fast");var b=a.find("form");CollectionWork.CollectionWorkForm.HijaxForm(b);var d=b.find(m);d.click(function(a){a.preventDefault();var b=$(a.target);y(b)});b.submit(function(){v(b,a);return c});Shared.Common.HijaxButtonHoverStates()},error:function(b){a.html(b.responseText)}})}function y(d){var a=d.parents(f),b=a.find(l);b.hide();var c=a.find(s);c.show()}function v(a,b){if(a.valid()){b.html(Shared.Common.ProgressImage);var c=a.attr("action");a.valid()&&$.ajax({type:"POST",url:c,data:a.serialize(),dataType:i,success:function(a){b.empty();Works.Index.RefreshCollectionWorks();Shared.Common.ShowUserMessage(a)},error:function(a){b.html(a.responseText)}})}}function t(e){var c=e.parents(f),g=c.find(".collectionTitle").html(),j="Are you sure you want to delete "+g+"?<p>(This will make the songs into singles.)</p>";$(p).attr(n,"Confirm").html(j).dialog({resizable:d,height:250,width:350,modal:d,overlay:{backgroundColor:o,opacity:.5},buttons:{Cancel:function(){$(this).dialog(b).dialog(a)},"Yes, delete":function(){var d=c.find(l);d.show();d.html(Shared.Common.ProgressImage);var f=$(e).attr(h);$.ajax({type:"POST",url:f,dataType:i,success:function(a){Shared.Common.ShowUserMessage(a);Works.Index.RefreshCollectionWorks();$("#singleWorks").html(Shared.Common.ProgressImage);Works.Index.RefreshSingleWorks()},error:function(a){d.html(a.responseText)}});$(this).dialog(b).dialog(a)}},close:function(){$(this).dialog(a)}})}function x(i){Shared.UploadManager.CancelAllUploads();var l=i.parents(f),p=l.find(q),m=p.find("img").attr("id"),c=$(r);c.attr(n,"Change the picture");c.find("p").html("Select a JPEG image to upload.  This will serve as the cover art for the collection.  Maximum file size allowed is 3MB.");var g=c.find(".flashBox");g.empty();var e="up"+(new Date).getTime();g.append('<div class="uploadButton" id="'+e+'"></div>');var s=$(i).attr(h);Shared.UploadManager.CurrentSWF=new SWFUpload({post_params:{AUTHID:global_SWFParam,ajax:d},upload_url:s,file_size_limit:"3 MB",file_types:"*.jpg",file_types_description:"JPG Images",file_upload_limit:"0",file_queue_limit:"1",button_placeholder_id:e,button_image_url:"/content/browse_file_hs.png",button_width:151,button_height:27,button_cursor:SWFUpload.CURSOR.HAND,flash_url:global_SWFUrl,custom_settings:{target_image:m,target_div:"uploadWindow"},file_dialog_complete_handler:Shared.UploadManager.FileDialogComplete,file_queued_handler:Shared.UploadManager.FileQueued,file_queue_error_handler:Shared.UploadManager.FileQueueError,upload_start_handler:Shared.UploadManager.UploadStart,upload_progress_handler:Shared.UploadManager.UploadProgress,upload_error_handler:Shared.UploadManager.UploadError,upload_complete_handler:Shared.UploadManager.UploadComplete,upload_success_handler:A,queue_complete_handler:z});$("#fileQueue").hide();$("#fileQueueList").empty();$("#btnUpload").removeClass(j);c.dialog({resizable:d,height:375,width:550,modal:d,overlay:{backgroundColor:o,opacity:.5},buttons:{Cancel:function(){Shared.UploadManager.CancelAllUploads();$(k).hide();$(this).dialog(b).dialog(a)}},close:function(){Shared.UploadManager.CancelAllUploads();$(k).hide();$(this).dialog(a)}})}function z(){$(k).hide()}function A(l,i){var c=$("#"+this.customSettings.target_image);c.attr(e,Shared.Common.ProgressImageUrl);var k=Shared.Common.ParseJson(i);c.attr(e,k.ImageUrl);var h=c.parents(f),d=h.find(g);d.removeClass(j);Shared.Common.ShowUserMessage({Type:1,Message:"Picture was changed."});$(r).dialog(b).dialog(a);Shared.UploadManager.CancelAllUploads()}function w(l){var k=l.parents(f),r=k.find(q),m=k.find(g),c=r.find("img"),u=c.attr(e),t=l.attr(h),s="Are you sure you want to remove the picture?";$(p).attr(n,"Confirm").html(s).dialog({resizable:d,height:250,width:350,modal:d,overlay:{backgroundColor:o,opacity:.5},buttons:{Cancel:function(){$(this).dialog(b).dialog(a)},"Yes, delete":function(){$.post(t,null,function(a){c.attr(e,Shared.Common.ProgressImageUrl);c.attr(e,a.ImageUrl);m.addClass(j);Shared.Common.ShowUserMessage({Type:1,Message:"Picture was removed."})},i);$(this).dialog(b).dialog(a)}},close:function(){$(this).dialog(a)}})}};if(!window.Shared)window.Shared={};Shared.AudioWorkList=new function(){var b="close",g="#uploadThrobber",c=true,h="href",j="#uploadWindow",i=".audioListContainer",e="json",d="POST",a="destroy",f=".audioWorkContainer",k=this;k.HijaxLists=function(){var c=".songDetail",b=".sortButton";$(".optionsListBox").click(function(e){var d=".downloadSong",c=".removeSong",b=".editSong";e.preventDefault();var a=$(e.target);if(a.is(b))m(a);else if(a.parent().is(b))m(a.parent());else if(a.is(c))l(a);else if(a.parent().is(c))l(a.parent());else if(a.is(d))Works.Index.HandleDownloadClick(a);else a.parent().is(d)&&Works.Index.HandleDownloadClick(a.parent())});$(f).hover(function(){$(this).find(b).show()},function(){$(this).find(b).hide()});$("div.audioListContainer").each(function(){$(this).sortable(a).sortable({axis:"y",containment:$(this).parent(),opacity:.8,handle:$(b),stop:function(){for(var c=$(this).find(f),g="",a=0;a<c.length;a++){var h=$(c[a]);g+=h.attr("id")+";"}var b=$(this),i=b.parent().find("input.audioSortRoute").val();$.ajax({type:d,url:i,data:"ids="+g,dataType:e,success:function(){Shared.AudioWorkList.RefreshAudioWorks(b)},error:function(a){$(this).html(a.responseText)}})}})});$(".songDetailMore").click(function(a){a.preventDefault();$(this).next(c).fadeIn()});$(".songDetailClose").click(function(a){a.preventDefault();$(this).parents(c).hide()})};k.RefreshAudioWorks=function(a){var b=$(a).parent().find("input.audioListRoute").val();$.ajax({type:"GET",url:b,dataType:"html",cache:false,success:function(b){a.html(b);Works.Index.HijaxAll();Shared.AudioWorkList.HijaxLists()},error:function(b){a.html(b.responseText)}})};k.HandleAddSongsClick=function(l){Shared.UploadManager.CancelAllUploads();var f=l.parents(".collectionBox"),m=f.find(i).attr("id"),d=$(j),n=f.find(".collectionTitle").html();d.attr("title","Add Songs to "+n);d.find("p").html("Select MP3 files to upload. You can upload 10 files at a time, and the maximum files size is 20MB.");var k=d.find(".flashBox");k.empty();var e="up"+(new Date).getTime();k.append('<div class="uploadButton" id="'+e+'"></div>');var p=$(l).attr(h);Shared.UploadManager.CurrentSWF=new SWFUpload({post_params:{AUTHID:global_SWFParam,ajax:c},upload_url:p,file_size_limit:"20 MB",file_types:"*.mp3;",file_types_description:"MP3 Files",file_upload_limit:"0",file_queue_limit:"10",button_placeholder_id:e,button_image_url:"/content/SelectAudioFiles_hs.png",button_width:138,button_height:27,button_cursor:SWFUpload.CURSOR.HAND,flash_url:global_SWFUrl,custom_settings:{target_div:"uploadWindow",container_div:m},file_dialog_complete_handler:Shared.UploadManager.FileDialogComplete,file_queued_handler:Shared.UploadManager.FileQueued,file_queue_error_handler:Shared.UploadManager.FileQueueError,upload_start_handler:Shared.UploadManager.UploadStart,upload_progress_handler:Shared.UploadManager.UploadProgress,upload_error_handler:Shared.UploadManager.UploadError,upload_success_handler:Shared.UploadManager.UploadSuccess,upload_complete_handler:Shared.UploadManager.UploadComplete,queue_complete_handler:o});$("#fileQueue").hide();$("#fileQueueList").empty();$("#btnUpload").removeClass("ui-state-disabled");d.dialog({resizable:c,height:400,width:550,modal:c,overlay:{backgroundColor:"#000",opacity:.5},buttons:{Cancel:function(){Shared.UploadManager.CancelAllUploads();$(g).hide();$(this).dialog(b).dialog(a)}},close:function(){Shared.UploadManager.CancelAllUploads();$(g).hide();$(this).dialog(a)}})};function o(){$(g).hide();Shared.Common.ShowUserMessages(Shared.UploadManager.UserMessages);var e=$("#"+this.customSettings.target_div),c=$("#"+this.customSettings.container_div);$(j).dialog(b).dialog(a);Shared.UploadManager.CancelAllUploads();c.html(Shared.Common.ProgressImage);Shared.AudioWorkList.RefreshAudioWorks(c)}function m(c){var d=$(c).attr(h),b=$(c).closest(f),a=b.next(".audioWorkEditContainer");b.hide();a.show().html(Shared.Common.ProgressImage);$.ajax({type:"GET",url:d,dataType:"html",cache:false,success:function(e){a.hide();a.html(e);a.fadeIn("fast");var c=a.find("form");AudioWork.AudioWorkForm.HijaxForm(c);var d=c.find("a.cancel");d.click(function(c){c.preventDefault();a.html("");a.hide();b.show()});c.submit(function(){n(c,a);return false});Shared.Common.HijaxButtonHoverStates()},error:function(b){a.html(b.responseText)}})}function n(b,a){if(b.valid()){a.html(Shared.Common.ProgressImage);var c=a.parents(i),f=b.attr("action");$.ajax({type:d,url:f,data:b.serialize(),dataType:e,success:function(a){Shared.AudioWorkList.RefreshAudioWorks(c);Shared.Common.ShowUserMessage(a)},error:function(b){a.html(b.responseText)}})}}function l(g){var f=g.parents(i),j=g.parents(".audioWorkDetailContainer").find(".songTitle").html(),k="Are you sure you want to remove "+j+" from the collection?";$("#modalWindow").attr("title","Confirm").html(k).dialog({resizable:c,height:200,width:350,modal:c,overlay:{backgroundColor:"#000",opacity:.5},buttons:{Cancel:function(){$(this).dialog(b).dialog(a)},"Yes, remove":function(){f.html(Shared.Common.ProgressImage);var c=$(g).attr(h);$.ajax({type:d,url:c,dataType:e,success:function(a){Shared.Common.ShowUserMessage(a);Shared.AudioWorkList.RefreshAudioWorks(f);$("#singleWorks").html(Shared.Common.ProgressImage);Works.Index.RefreshSingleWorks()},error:function(a){f.html(a.responseText)}});$(this).dialog(b).dialog(a)}},close:function(){$(this).dialog(a)}})}};if(!window.Shared)window.Shared={};Shared.AudioWorkSingleList=new function(){var f="#uploadThrobber",n="#uploadWindow",i="#singleWorks",a="destroy",c="close",d=true,h="json",g="POST",m=".audioListContainer",j="a.cancel",b=false,l=".audioWorkEditContainer",k=".audioWorkContainer",e="href",v=this;v.HijaxSingles=function(){$(".optionsListBox").click(function(f){var e=".downloadSingle",d=".addToCollection",c=".deleteSingle",b=".editSingle";f.preventDefault();var a=$(f.target);if(a.is(b))q(a);else if(a.parent().is(b))q(a.parent());else if(a.is(c))o(a);else if(a.parent().is(c))o(a.parent());else if(a.is(d))p(a);else if(a.parent().is(d))p(a.parent());else if(a.is(e))Works.Index.HandleDownloadClick(a);else a.parent().is(e)&&Works.Index.HandleDownloadClick(a.parent())});$(".addSingle").click(function(a){a.preventDefault();var b=$(a.target);t(b)})};function p(c){var f=$(c).attr(e),d=$(c).closest(k),a=d.next(l);$.ajax({type:"GET",url:f,dataType:"html",cache:b,success:function(e){a.toggle("blind",null,200);a.html(e);var c=a.find("form");AudioWork.AddToCollectionForm.HijaxForm(c);var d=c.find(j);d.click(function(b){b.preventDefault();a.html("");a.hide()});c.submit(function(){r(c,a);return b})},error:function(b){a.show().html(b.responseText)}})}function r(b,a){a.html(Shared.Common.ProgressImage);var d=a.parents(m),c=b.attr("action");$.ajax({type:g,url:c,data:b.serialize(),dataType:h,success:function(a){Works.Index.RefreshCollectionWorks();Works.Index.RefreshSingleWorks();Shared.Common.ShowUserMessage(a)},error:function(b){a.html(b.responseText)}})}function q(d){var f=$(d).attr(e),c=$(d).closest(k),a=c.next(l);c.hide();a.show().html(Shared.Common.ProgressImage);$.ajax({type:"GET",url:f,dataType:"html",cache:b,success:function(f){a.hide();a.html(f);a.fadeIn("fast");var d=a.find("form");AudioWork.AudioWorkForm.HijaxForm(d);var e=d.find(j);e.click(function(b){b.preventDefault();a.html("");a.hide();c.show()});d.submit(function(){s(d,a);return b});Shared.Common.HijaxButtonHoverStates()},error:function(b){a.html(b.responseText)}})}function s(b,a){if(b.valid()){a.html(Shared.Common.ProgressImage);var d=a.parents(m),c=b.attr("action");$.ajax({type:g,url:c,data:b.serialize(),dataType:h,success:function(a){Works.Index.RefreshSingleWorks();Shared.Common.ShowUserMessage(a)},error:function(b){a.html(b.responseText)}})}}function o(b){var f=b.parents(".audioWorkDetailContainer").find(".songTitle").html(),j="Are you sure you want to delete "+f+"?";$("#modalWindow").attr("title","Confirm").html(j).dialog({resizable:d,height:200,width:350,modal:d,overlay:{backgroundColor:"#000",opacity:.5},buttons:{Cancel:function(){$(this).dialog(c).dialog(a)},"Yes, delete":function(){$(i).html(Shared.Common.ProgressImage);var d=$(b).attr(e);$.ajax({type:g,url:d,dataType:h,success:function(a){Shared.Common.ShowUserMessage(a);Works.Index.RefreshSingleWorks()},error:function(a){audioListContainer.html(a.responseText)}});$(this).dialog(c).dialog(a)}},close:function(){$(this).dialog(a)}})}function t(j){Shared.UploadManager.CancelAllUploads();var b=$(n);b.attr("title","Add Single Songs");b.find("p").html("Select audio files to upload. You can upload Wave, FLAC, or MP3 files. You can upload 10 files at a time, and the maximum files size is 64MB.");var h=b.find(".flashBox");h.empty();var g="up"+(new Date).getTime();h.append('<div class="uploadButton" id="'+g+'"></div>');var k=$(j).attr(e);Shared.UploadManager.CurrentSWF=new SWFUpload({post_params:{AUTHID:global_SWFParam,ajax:d,license:"by"},upload_url:k,file_size_limit:"64 MB",file_types:"*.wav;*.flac;*.mp3;",file_types_description:"Audio Files",file_upload_limit:"0",file_queue_limit:"10",button_placeholder_id:g,button_image_url:"/content/SelectAudioFiles_hs.png",button_width:138,button_height:27,button_cursor:SWFUpload.CURSOR.HAND,flash_url:global_SWFUrl,custom_settings:{target_div:"uploadWindow",container_div:$(i)},file_dialog_complete_handler:Shared.UploadManager.FileDialogComplete,file_queued_handler:Shared.UploadManager.FileQueued,file_queue_error_handler:Shared.UploadManager.FileQueueError,upload_start_handler:Shared.UploadManager.UploadStart,upload_progress_handler:Shared.UploadManager.UploadProgress,upload_error_handler:Shared.UploadManager.UploadError,upload_success_handler:Shared.UploadManager.UploadSuccess,upload_complete_handler:Shared.UploadManager.UploadComplete,queue_complete_handler:u});$("#fileQueue").hide();$("#fileQueueList").empty();$("#btnUpload").removeClass("ui-state-disabled");b.dialog({resizable:d,height:400,width:550,modal:d,overlay:{backgroundColor:"#000",opacity:.5},buttons:{Cancel:function(){Shared.UploadManager.CancelAllUploads();$(f).hide();$(this).dialog(c).dialog(a)}},close:function(){Shared.UploadManager.CancelAllUploads();$(f).hide();$(this).dialog(a)}})}function u(){$(f).hide();Shared.Common.ShowUserMessages(Shared.UploadManager.UserMessages);$(n).dialog(c).dialog(a);Shared.UploadManager.CancelAllUploads();$(i).html(Shared.Common.ProgressImage);Works.Index.RefreshSingleWorks()}};if(!window.AudioWork)window.AudioWork={};AudioWork.AudioWorkForm=new function(){var a=this;a.HijaxForm=function(b){var a=true;b.find("a.licenseHelp").click(function(d){d.preventDefault();var b=$("#modalWindow"),c=$(d.target).attr("href");if(!c)c=$(d.target).parent().attr("href");b.attr("title","Available Licenses");b.dialog({resizable:a,height:300,width:450,buttons:{Close:function(){b.dialog("destroy")}},open:function(){b.html(Shared.Common.ProgressImage);$.get(c,"",function(a){b.html(a)},"html")},close:function(){b.dialog("destroy")}})});b.find(".suggestTags").autocomplete(Shared.Common.SuggestTagsUrl,{delay:40,selectFirst:a,multiple:a,highlight:false});b.validate({errorClass:"ui-state-error",errorElement:"div",rules:{Title:{required:a,maxlength:100}},messages:{Title:{maxlength:"The Title is too long (up to 100 characters allowed)"}}});b.find("input:first").focus()}};if(!window.AudioWork)window.AudioWork={};AudioWork.AddToCollectionForm=new function(){var a=this;a.HijaxForm=function(a){a.find("#ddlCollection").change(function(){a.valid()&&a.submit()});a.validate({errorClass:"ui-state-error",errorElement:"div",rules:{CollectionIdentifier:{required:true}},messages:{CollectionIdentifier:{maxlength:"Please choose a collection"}}})}};if(!window.Music)window.Music={};Music.DownloadForm=new function(){var a=this;a.Ready=function(){Shared.Common.HijaxButtonHoverStates();$(".confirmDownloadButton").click(function(){$("#downloadWindow").dialog("close")})}};if(!window.Works)window.Works={};Works.Index=new function(){var a="html",b=this;b.HijaxAll=function(){Shared.OptionsLink.HijaxOptionsLinks();Works.CollectionWorkList.HijaxCollections();Shared.AudioWorkList.HijaxLists();Shared.AudioWorkSingleList.HijaxSingles()};b.RefreshCollectionWorks=function(){c($("#collectionWorks"),global_collectionWorksUrl)};b.RefreshSingleWorks=function(){var b=$("#singleWorks"),c=b.parents("#singlesBox");$.ajax({type:"GET",url:global_singleWorksUrl,dataType:a,cache:false,success:function(a){b.html(a);if(a=="")c.hide();else c.show();Works.Index.HijaxAll()},error:function(a){b.html(a.responseText)}})};b.HandleDownloadClick=function(c){var d=$(c).attr("href"),b=$("#downloadWindow");b.dialog({height:400,width:600,modal:true,overlay:{backgroundColor:"#000",opacity:.5},buttons:{Cancel:function(){b.dialog("destroy")}},open:function(){b.html(Shared.Common.ProgressImage);$.ajax({type:"GET",url:d,dataType:a,cache:false,success:function(a){b.html(a);Music.DownloadForm.Ready()},error:function(a){b.html(a.responseText)}})},close:function(){b.dialog("destroy")}})};function c(b,c){$.ajax({type:"GET",url:c,dataType:a,cache:false,success:function(a){b.html(a);Works.Index.HijaxAll()},error:function(a){b.html(a.responseText)}})}};$(function(){Works.Index.HijaxAll()})